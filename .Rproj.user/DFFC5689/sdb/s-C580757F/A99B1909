{
    "contents" : "rm(list=ls())\n#1 t- test\nA <- c(67,80,106,83,89)\nB <- c(45,71,87,53)\n\n#calculated by hand\nmean.A <- mean(A)\nsd.A <- sd(A)\nn.A = length(A)\n\nmean.B <- mean(B)\nsd.B <- sd(B)\nn.B = length(B)\n\nsd.pooled2 <- (sd.A^2*(n.A-1)+sd.B^2*(n.B-1))/(n.A+n.B-2) \nsd.pooled = sqrt(sd.pooled2)\nt.value = (mean.A-mean.B)/(sd.pooled*(1/n.A+1/n.B)^(1/2))\nt.value\n\ndf = n.A+n.B -2\n\n\npvalue = 2*(1- pt(t.value,df = df))\npvalue\n\nt.test(A,B,var.equal = T)\n\n## weltch's t test, for unequal variance\nt2 = (mean.A -mean.B) / sqrt(sd.A^2/n.A+sd.B^2/n.B)\nt2\ndf2 =  (sd.A^2/n.A+sd.B^2/n.B)^2 / (sd.A^4/n.A^2/(n.A-1)+sd.B^4/n.B^2/(n.B-1))\ndf2\n2*(1 - pt(t2, df2))\nt.test(A,B)  \n\n## from wikipedia : subtle difference:\n# In statistics, Welch's t-test (or unequal variances t-test) is a two-sample location test,\n# and is used to test the hypothesis \n# that two populations have equal means. Welch's t-test is an adaptation of Student's t-test,\n# and is more reliable when the two samples have unequal variances and unequal sample sizes.\n# These tests are often referred to as \"unpaired\" or \"independent samples\" t-tests, \n# as they are typically applied when the statistical units underlying the two samples being \n# compared are non-overlapping.\n\n\n## problem 2 \nx <- c(1.4, 1.2, 1.2, 1.3, 1.5, 1.0, 2.1,1.4,1.1)\nqqnorm(x)\nqqline(x)\ns2 <- var(x)\nn.x = length(x)\nsigma =0.4\nchi.value <- s2/sigma^2\nchi.value\n2*(pchisq(chi.value,n.x-1))\n\n\n## in-buit test\nchisq.test(x)\n# data:  x\n# X-squared = 0.60656, df = 8, p-value = 0.9997\n# \n# Warning message:\n#   In chisq.test(x) : Chi-squared approximation may be incorrect\n\n#delete potential outlier 2.1\nx.new <- x[-which(x==2.1)]\nqqnorm(x.new)\nqqline(x.new)\nchisq.test(x.new)\n",
    "created" : 1454555627596.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1556656586",
    "id" : "A99B1909",
    "lastKnownWriteTime" : 1454874969,
    "path" : "~/Stat/Teaching/stat424/code/project1/disc3.R",
    "project_path" : "project1/disc3.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}