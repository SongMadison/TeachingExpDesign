{
    "contents" : "\nrm(list = ls())\n# Question 3\nregimes  <- data.frame(list(\n    Group  =  factor(rep(1:5, 3)) ,\n    trt = rep(c(\"A\",\"B\",\"C\"), each = 5),\n    weightloss = c(15,24,31,37,33,10,15,28,36,37,8,17,34,34,39)\n   ))\n## graphical analysis:\nlibrary(ggplot2)\nggplot(data = regimes, aes(x= Group, y= weightloss, color = trt )) +\n  geom_point()+\n  geom_line()+\n  ggtitle(label = \"weightloss of different regimes\")\n\n# trt A seems have a good effect. all are similar though.\n# some further test:\n\n#consider group as block -- randomized complete block desgin\naov1 <- aov(weightloss ~ Group+ trt, data = regimes)\nsummary(aov1)\n\n\n\n\n## if we know, reduced proportion\nweights <- c(250,309,327,356,379)\nregimes$weights <-rep(weights,3)\nregimes$ratio <- regimes$weightloss/regimes$weights\naov2 <- aov(ratio ~ trt, data =regimes)\nsummary(aov2)\n\n#conclusions : trt still not significant.\n\n## if you want to calculate all kindso group means\nlibrary(dplyr)\ngroup.mean <- regimes %>%\n     dplyr::group_by(Group) %>%\n     dplyr::summarize(mean(weightloss))\ntrt.mean <- regimes %>%\n  dplyr::group_by(trt) %>%\n  dplyr::summarize(mean(weightloss))\n\n#graphial ANOVA\nlayout(matrix(1:3,3))\nstripchart(group.mean$`mean(weightloss)`, ylim = c(0,4) ,col =\"red\",main=\"group mean\")\nstripchart(trt.mean$`mean(weightloss)`, ylim = c(0,4) ,method = 'jitter', col =\"blue\", main= \"trt mean\")\nstripchart(aov1$residuals, main=\"residuals\", method= \"jitter\")\n\n\nlibrary(ggplot2)\np1 <- ggplot(data.frame(x = group.mean$`mean(weightloss)`,y =rep(1,5)), aes(x,y)) + geom_point( )\np2 <- qplot(x,y, data= data.frame(x= trt.mean$`mean(weightloss)`,y = rep(2,3)), color = I(\"blue\"))\np3 <- ggplot(data.frame(x= aov1$residuals, y = rep(1,15)), aes(x,y))+geom_point(color = \"red\")\nlibrary(gridExtra)\ngrid.arrange(p1,p2,p3)\n\n\n\n### Question 4\nprocess <- data.frame(list(\n  runs = 1:32,\n  block = factor(rep(1:8, each =4)),\n  variants = unlist(strsplit(\"CBDABDACDABCADCBADBCDCABBDCACDAB\", split=\"\")),\n  results = c(56,60,69,61,62,70,65,65,\n             66,63,52,57,58,60,61,66,\n             56,61,53,52,62,57,59,58,\n             60,68,61,65,63,68,61,55)\n  \n))\n\naov2 <- aov(results ~ block + variants, data =process)\nsummary(aov2) \n#graphial ANOVA\nlayout(matrix(1:3,3))\nstripchart(block.mean$`mean(results)` ,col =\"red\",main=\"group mean\")\nstripchart(variants.mean$`mean(results)`,method = 'jitter', col =\"blue\", main= \"trt mean\")\nstripchart(aov2$residuals, main=\"residuals\", method= \"jitter\")\n\n## part C:\nsigma.hat = sqrt ( sum(aov2$residuals^2)/21 )\nt.crit <- qt(0.025, 21)\nSE1 = t.crit * sigma.hat / sqrt(8) \n\n\n#confidence intervals for block\nlibrary(dplyr)\nblock.mean <- process %>%\n  dplyr::group_by(block) %>%\n  dplyr::summarize(mean(results))\nvariants.mean <- process %>%\n  dplyr::group_by(variants) %>%\n  dplyr::summarize(mean(results))\n#variants (process):\ndata.frame(list('0.025' = variants.mean$`mean(results)`-SE1,\n                '0.975' = variants.mean$`mean(results)`+SE1\n))\n\n#question d)\nplot(aov2$residuals, main =\"rediduals over time\", ylab =\"residuals\")\n\n#part (e)\nplot(block.mean,ylab = \"averages\", xlab=\"time\", main=\"averages over time\")\nlines(block.mean, col =\"red\")\n## really big variation among those means of fun runs at different times\n\n\n## Question 5\n# don't think about the time/ blocking struture.\naov3 <- aov(results ~ variants, data = process)\nsummary(aov3)\n\nsigma.hat2 = sqrt ( sum(aov3$residuals^2)/28 )\nt.crit2 <- qt(0.025, 28)\nSE2 = t.crit2 * sigma.hat2 / sqrt(8) \n\n\n#variants (process):\ndata.frame(list('0.025' = variants.mean$`mean(results)`-SE2,\n                '0.975' = variants.mean$`mean(results)`+SE2\n))\n\nSE1/SE2\n",
    "created" : 1455751646307.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1484935029",
    "id" : "F1509214",
    "lastKnownWriteTime" : 1455769578,
    "path" : "~/Stat/Teaching/stat424/code/disc5.R",
    "project_path" : "disc5.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}